# VBA of Wall Street

## Overview of Project / Purpose
Initially, we created a way for Steve to analyze data from his “2017” and “2018” worksheets so that he could analyze stock market data over a dozen different stocks.  Now that Steve had seen our workbook that we prepared for him, he wanted to analyze more data from the stock market – much more data than we originally helped him with. Since Steve wanted to do additional research on the entire stock market, we needed to update our previous VBA code that we gave him so that it was more efficient in handling larger datasets.  This was done by omitting several portions of the original VBA code (namely the nested for loop).  We end our project by showcasing how much faster we can analyze the original 2017 and 2018 stock data that Steve provided us using the refactored VBA code, while also discussing the pros and cons to the refactorization of code in general.

## Results
As mentioned previously, we refactored our original code so that it would analyze the 2017 and 2018 stock data significantly faster than it did originally.  This was done by “unpacking” the nested for loop that we originally wrote into two separate for loops that more efficiently iterated across the dataset.  For example, in the screenshots provided below, we see that the analysis of the 2017 data was done in approximately 0.899 seconds, while the refactored version was done in approximately 0.117 seconds. 
![VBA_Challenge_2017](https://user-images.githubusercontent.com/115128743/199390575-716a5532-8df2-41de-b3d7-f532df4aee74.png)
![VBA_Challenge_2017_Refactored](https://user-images.githubusercontent.com/115128743/199390608-03ec48e0-8bb2-4c3c-b95f-2b45406248b2.png)

Similarly, we can see that the analysis of the 2018 data was done in approximately 0.867 seconds, while the refactored version was done in approximately 0.156 seconds. 
![VBA_Challenge_2018](https://user-images.githubusercontent.com/115128743/199390677-82f750a6-e372-48bc-a975-21c08d325694.png)
![VBA_Challenge_2018_Refactored](https://user-images.githubusercontent.com/115128743/199390688-9c67b4a1-cf92-40a8-bb98-0b2e99ddd11b.png)
The refactored version of our code does the same analysis in less than a fifth of the time of the original!  

## Summary
### Advantages of Refactorization
In general, there are many advantages to refactoring code.  It is good practice to be as concise as possible when writing code that will be used to perform some type of analysis, as it will save time when dealing with datasets that require a large amount of computing power.  Another important advantage in refactoring code is the wider range of applications that the code can now perform.  If the original code could only handle small datasets, then we were limited as to how much data we could analyze and thus make observations on.  This would be detrimental in real life situations where we need to draw observations from as much data as possible to make the best possible conclusions and inferences.  In Steve’s case, these advantages are obvious.  The main advantage of refactoring our original VBA code was to perform the analysis on the 2017 and 2018 stock datasets more efficiently.  In addition to this, our updated code can now handle larger datasets and thus be used to make more observations that could prove to be beneficial to Steve in his stock market endeavors.  	
	
### Disadvantages of Refactorization																
Though there are many benefits to refactoring code, this process does have its downsides.  In general, this process is time consuming, and this time spent on refactorization could have been spent on other facets of the project at hand.  Also, given that one must spend more time on their code when refactoring it, it is much more likely for mistakes to be made.  In trying to make the code more efficient, it is possible to accidentally alter it so that it no longer performs the tasks that we would have originally wanted it to perform.  This was evident in our refactorization of the VBA code for Steve.  There were several points in the refactorization that resulted in errors that made the new code incorrect.  For example, after refactoring the original VBA code and running it to see if it worked, it was evident that the new code no longer asked the user what year they wanted to perform the analysis on.  Though this mistake was eventually fixed, it did take a relatively large amount of time to fix.  Mistakes like these are more likely to be made when more time is spent altering the code, and thus a balance between over-refactorization and settling for the performance of the current code must be made.   
